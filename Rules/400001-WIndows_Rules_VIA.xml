<!--
  -  Microsoft Windows rules Via
  -  Author: Dathan Nobrega.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2.
-->

<!-- 18100 Group of windows rules. -->
<rule id="400001" level="10">
    <if_sid>18100</if_sid>
    <id>^1074$|^6006$|^6005$</id>
    <description>Desligamento ou reinicialização normal do Windows</description>
    <group>windows,shutdown,</group>
</rule>
<rule id="400002" level="10">
    <if_sid>18100</if_sid>
    <id>^6008$</id>
    <description>Desligamento anormal detectado no Windows</description>
    <group>windows,shutdown,</group>
</rule>
<rule id="400003" level="9" timeframe="3600">
    <if_sid>400001</if_sid>
    <time>20:00:00</time>
    <description>Desligamento fora do horário comercial</description>
    <group>windows,after_hours,</group>
</rule>
<!-- 61614 é utilizado para (Sysmon - Event 12:) -->
<rule id="400004" level="7">
    <!-- quando o uma midia removivel é colocado no host -->
    <if_sid>18100</if_sid>
    <id>^6416$|^43$|^2003$</id>
    <description>Mídia removível conectada</description>
    <group>windows,usb,</group>
</rule>

<!-- 18116 é utilizado para (User account locked out (multiple login errors) -->

<!-- <rule id="100005" level="10">
    <if_sid>18116</if_sid>
    <match>Group:.*Administrators</match>
    <description>Usuário adicionado ao grupo de Administradores</description>
    <group>windows,group_changes,privilege_escalation,</group>
</rule> -->

<rule id="100006" level="7">
    <if_sid>18117</if_sid>
    <match>Group:.*Administrators</match>
    <description>Usuário removido do grupo de Administradores</description>
    <group>windows,group_changes,</group>
</rule>
<rule id="100008" level="12">
<if_sid>18102</if_sid>
    <!-- Devemos alterar o nome das cotnas de acordo com o padrão de segurança da empresa, para evitar o uso de contas padrão. -->
    <regex>User Name:\s*(Administrator|admin|test|guest)</regex>
    <description>Login com conta padrão detectado</description>
    <group>windows,authentication_success,default_accounts,</group>
</rule>

<rule id="100009" level="13">
    <if_sid>18102</if_sid>
    <match>Logon Type:\s*(2|10)</match>
    <regex>User Name:\s*(svc_|service_)\w+</regex>
    <description>Uso interativo de conta de serviço detectado</description>
    <group>windows,misuse,service_account,</group>
</rule>
  
  