<!-- Decoder utilizado para monitoramento do syslog do vSphere 8 -->

<!-- Example of log:
Oct  5 08:14:25 DTNUDIESXI01.datan.com.br Hostd[525383]: [Originator@6876 sub=Vimsvc.ha-eventmgr]Event 643 : DTN00001V on  DTNUDIESXI01.datan.com.br in ha-datacenter is powered off
-->

<decoder name="VMware-vShpere8">
  <prematch>Hostd</prematch>
  <regex>(\w+\s+\d+\s+\d+:\d+:\d+) (\S+) (\S+)[(\d+)]: [Originator@(\d+) sub=(\S+)] Event (\d+) : (\.+)</regex>
  <order>time,system_name,program_name,extra_data,originator,subsystem,event,action</order>
</decoder>

<decoder name="Hostd">
  <program_name>Hostd</program_name>
</decoder>

<!-- Logs de Hostd -->

<decoder name="Hostd">
  <parent>Hostd</parent>
  <prematch>(\w+\s+\d+\s+\d+:\d+:\d+) (\S+) Hostd[(\d+)]:</prematch>
  <regex>(\w+\s+\d+\s+\d+:\d+:\d+) (\S+) (\S+)[(\d+)]: [Originator@(\d+) sub=(\S+)] Event (\d+) : (\.+)</regex>
  <order>time,system_name,program_name,extra_data,module_number,subsystem,event,action</order>
</decoder>


<!-- Oct  5 08:00:20 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="root" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.createFilter" result="success"]
Oct  5 08:00:20 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="root" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.retrievePropertiesEx" result="success"]
Oct  5 08:00:20 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="root" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.waitForUpdatesEx" result="success"]
Oct  5 08:00:20 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="root" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.retrievePropertiesEx" result="success"]
Oct  5 08:00:20 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="root" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.retrievePropertiesEx" result="success"]
Oct  5 08:00:22 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="vpxuser" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.waitForUpdates" result="success"]
Oct  5 08:00:22 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="root" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.waitForUpdatesEx" result="success"]
Oct  5 08:00:22 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="vpxuser" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.waitForUpdates" result="success"]
Oct  5 08:00:43 DTNUDIESXI01.datan.com.br Hostd[525417]: [Originator@6876 sub=Solo.HttpSvc.HTTPService.HttpConnection] HTTP Connection read failed while waiting for further requests; <io_obj p:0x000000f0481971d8, h:-1, <TCP '127.0.0.1 : 8309'>, <TCP '127.0.0.1 : 33877'>>, N7Vmacore16TimeoutExceptionE(Operation timed out: Stream: <io_obj p:0x000000f0481971d8, h:-1, <TCP '127.0.0.1 : 8309'>, <TCP '127.0.0.1 : 33877'>>, duration: 00:00:48.523857 (hh:mm:ss.us))
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="vpxuser" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.waitForUpdates" result="success"]
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="vpxuser" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.checkForUpdates" result="success"]
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525405]: [Originator@6876 sub=Vmsvc.vm:/vmfs/volumes/6513af56-7bb10cda-3eba-309c231dafbf/DTN00001V/DTN00001V.vmx] Fault Tolerance state callback received
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525405]: [Originator@6876 sub=Vmsvc.vm:/vmfs/volumes/6513af56-7bb10cda-3eba-309c231dafbf/DTN00001V/DTN00001V.vmx] sleepState value is 0
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525405]: [Originator@6876 sub=Vmsvc.vm:/vmfs/volumes/6513af56-7bb10cda-3eba-309c231dafbf/DTN00001V/DTN00001V.vmx] VM notification timeout 0
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525405]: [Originator@6876 sub=Vmsvc.vm:/vmfs/volumes/6513af56-7bb10cda-3eba-309c231dafbf/DTN00001V/DTN00001V.vmx] No Upgrade required
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525405]: [Originator@6876 sub=Vmsvc.vm:/vmfs/volumes/6513af56-7bb10cda-3eba-309c231dafbf/DTN00001V/DTN00001V.vmx] Ignored toolsManifestInfo update of size 0
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525405]: [Originator@6876 sub=Vmsvc.vm:/vmfs/volumes/6513af56-7bb10cda-3eba-309c231dafbf/DTN00001V/DTN00001V.vmx] Skip a duplicate transition to: VM_STATE_ON
Oct  5 08:00:54 DTNUDIESXI01.datan.com.br Hostd[525371]: [api.call@6876 subject="vpxuser" object="vmodl.query.PropertyCollector:ha-property-collector:vmodl.query.PropertyCollector.waitForUpdates" result="success"] -->
